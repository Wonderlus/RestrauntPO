<UserControl x:Class="Restraunt.Controls.MainContent"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Restraunt.Controls"
             xmlns:models="clr-namespace:Restraunt.Models;assembly=Models"
             xmlns:conv="clr-namespace:Restraunt.Converters"
             xmlns:services="clr-namespace:Restraunt.Services"
 
                mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibility"/>
        <conv:ImagePathToPackUriConverter x:Key="ImageConverter"/>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header row -->
        <DockPanel Grid.Row="0" Margin="0,0,0,12">
            <StackPanel DockPanel.Dock="Left">
                <TextBlock Text="Ð‘Ð»ÑŽÐ´Ð°" FontSize="22" FontWeight="Bold" Foreground="{StaticResource OrangeText}"/>
            </StackPanel>
            <Button DockPanel.Dock="Right"
                    Style="{StaticResource PrimaryButton}"
                    Content="+ Add new dish"
                    Command="{Binding AddDishCommand}"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Margin="0,0,0,0"
                    MinWidth="140"
                    Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVisibility}}"
                    Height="40"/>

        </DockPanel>

        <!-- Cards -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <ItemsControl x:Name="DishesList" ItemsSource="{Binding Dishes}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel IsItemsHost="True" Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type models:DishModel}">
                        <Border Width="250"
                                MinHeight="380"
                                Margin="0,0,16,16"
                                Background="{StaticResource CardBg}"
                                BorderBrush="{StaticResource OrangeBorder}"
                                BorderThickness="1"
                                CornerRadius="12">

                            <Grid>
                                <Grid.RowDefinitions>
                                    <!-- ÐšÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐ° -->
                                    <RowDefinition Height="140"/>
                                    <!-- ÐšÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ (Ñ€Ð°ÑÑ‚ÑÐ³Ð¸Ð²Ð°ÐµÑ‚ÑÑ) -->
                                    <RowDefinition Height="*"/>
                                    <!-- ÐÐ¸Ð¶Ð½ÑÑ Ð¿Ð°Ð½ÐµÐ»ÑŒ (Ð²ÑÐµÐ³Ð´Ð° ÑÐ½Ð¸Ð·Ñƒ) -->
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- ===== ÐšÐÐ Ð¢Ð˜ÐÐšÐ ===== -->
                                <Grid Grid.Row="0">
                                    <Image Source="{Binding ImageUrl, Converter={StaticResource ImageConverter}}"
                                           Stretch="UniformToFill"/>

                                    <!-- Ð‘ÐµÐ¹Ð´Ð¶Ð¸ -->
                                    <StackPanel Orientation="Horizontal"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                Margin="8">

                                        <Border Background="#FFF59E0B"
                                                CornerRadius="6"
                                                Padding="6,2"
                                                Margin="0,0,6,0"
                                                Visibility="{Binding IsSeasonal, Converter={StaticResource BoolToVisibility}}">
                                            <TextBlock Text="Ð¡Ð•Ð—ÐžÐÐÐžÐ•"
                                                       Foreground="White"
                                                       FontSize="10"
                                                       FontWeight="Bold"/>
                                        </Border>

                                        <Border Background="#FFEF4444"
                                                CornerRadius="6"
                                                Padding="6,2"
                                                Visibility="{Binding IsPromotional, Converter={StaticResource BoolToVisibility}}">
                                            <TextBlock Text="ÐÐšÐ¦Ð˜Ð¯"
                                                       Foreground="White"
                                                       FontSize="10"
                                                       FontWeight="Bold"/>
                                        </Border>

                                    </StackPanel>
                                </Grid>

                                <!-- ===== ÐšÐžÐÐ¢Ð•ÐÐ¢ ===== -->
                                <StackPanel Grid.Row="1" Margin="12,12,12,0">
                                    <TextBlock Text="{Binding Name}"
                                               FontWeight="SemiBold"
                                               FontSize="15"
                                               Foreground="{StaticResource OrangeText}"/>

                                    <TextBlock Text="{Binding CategoryName}"
                                               Foreground="#FFB07340"
                                               FontSize="11"
                                               Margin="0,2,0,6"/>

                                    <TextBlock Text="{Binding Description}"
                                               TextWrapping="Wrap"
                                               FontSize="11"
                                               Margin="0,0,0,6"/>

                                    <TextBlock Text="{Binding Price, StringFormat='{}{0} â‚½'}"
                                               FontWeight="Bold"/>
                                </StackPanel>

                                <!-- ===== ÐÐ˜Ð–ÐÐ¯Ð¯ ÐŸÐÐÐ•Ð›Ð¬ (Ð’Ð¡Ð•Ð“Ð”Ð Ð’ÐÐ˜Ð—Ð£) ===== -->
                                <Border Grid.Row="2"
                                        BorderBrush="{StaticResource OrangeBorder}"
                                        BorderThickness="0,1,0,0"
                                        Padding="12"
                                        Margin="0,10,0,0">

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <!-- Ñ‚ÐµÐºÑÑ‚ -->
                                            <ColumnDefinition Width="*"/>
                                            <!-- ÐºÐ½Ð¾Ð¿ÐºÐ° + -->
                                            <ColumnDefinition Width="Auto"/>
                                            <!-- Ð°Ð´Ð¼Ð¸Ð½-ÐºÐ½Ð¾Ð¿ÐºÐ¸ -->
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Ð¢Ð•ÐšÐ¡Ð¢: ÑÐ»ÐµÐ²Ð° -->
                                        <TextBlock Grid.Column="0"
                                                   Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ"
                                                   Foreground="#FFB07340"
                                                   FontSize="12"
                                                   VerticalAlignment="Center"/>

                                        <!-- ÐšÐÐžÐŸÐšÐ + : ÑÐ¿Ñ€Ð°Ð²Ð° Ð¾Ñ‚ Ñ‚ÐµÐºÑÑ‚Ð° -->
                                        <Button Grid.Column="1"
                                                Style="{StaticResource IconButton}"
                                                Content="+"
                                                Command="{Binding DataContext.AddToBasketCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                CommandParameter="{Binding}"/>

                                        <!-- ÐÐ”ÐœÐ˜ÐÐ¡ÐšÐ˜Ð• ÐšÐÐžÐŸÐšÐ˜: Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾ ÑÐ¿Ñ€Ð°Ð²Ð° -->
                                        <StackPanel Grid.Column="2"
                                                    Orientation="Horizontal"
                                                    VerticalAlignment="Center"
                                                    Visibility="{Binding DataContext.IsAdmin,
                                                                         RelativeSource={RelativeSource AncestorType=UserControl},
                                                                         Converter={StaticResource BoolToVisibility}}">
                                            <Button Style="{StaticResource IconButton}"
                                                    Content="âœ"
                                                    Margin="0,0,6,0"
                                                    Command="{Binding DataContext.EditDishCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                    CommandParameter="{Binding}"/>
                                            <Button Style="{StaticResource IconButton}"
                                                    Content="ðŸ—‘"
                                                    Command="{Binding DataContext.DeleteDishCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                    CommandParameter="{Binding}"/>
                                        </StackPanel>

                                    </Grid>
                                </Border>
                            </Grid>
                        </Border>
                    </DataTemplate>

                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl>
